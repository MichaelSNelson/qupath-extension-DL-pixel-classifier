[workspace]
channels = ["conda-forge", "pytorch"]
platforms = ["linux-64", "osx-arm64", "osx-64", "win-64"]

# CUDA hint: tells pixi that CUDA 12 is available on the host.
# macOS ignores this (no NVIDIA support). On Linux/Windows it steers
# the resolver to the CUDA variant of PyTorch.
[system-requirements]
cuda = "12"

[dependencies]
python = "3.10.*"
appose = ">=0.7.2"
numpy = ">=1.24.0,<2.0"
pillow = ">=10.0.0"
scikit-image = ">=0.21.0"
tifffile = ">=2023.7.0"
imagecodecs = ">=2023.7.0"
pydantic = ">=2.0.0"

# PyTorch (base dependency for all platforms)
pytorch = ">=2.1.0"
torchvision = ">=0.16.0"

# CUDA GPU support: pytorch-gpu steers the resolver to the CUDA variant.
# Only exists for Linux and Windows (macOS has no NVIDIA GPU support).
[target.linux-64.dependencies]
pytorch-gpu = ">=2.1.0"

[target.win-64.dependencies]
pytorch-gpu = ">=2.1.0"

[pypi-dependencies]
segmentation-models-pytorch = ">=0.3.3"
albumentations = ">=1.3.0"
timm = ">=1.0.0"
ttach = ">=0.0.3"

# ONNX (optional, for exported models)
onnx = ">=1.15.0"
onnxruntime = ">=1.16.0"

# DL classifier server (from GitHub)
dlclassifier-server = { git = "https://github.com/MichaelSNelson/qupath-extension-DL-pixel-classifier.git", subdirectory = "python_server" }
